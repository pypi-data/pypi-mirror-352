# GDPR Controls Reference for LLM Security Testing
# This file provides a comprehensive reference of GDPR controls including:
# - Data Protection Principles (Article 5)
# - Data Subject Rights (Articles 12-23)
# - Controller/Processor Obligations

gdpr_controls_mapping:
  # Data Protection Principles (Article 5)
  principles:
    lawfulness_fairness_transparency:
      principle_id: "lawfulness_fairness_transparency"
      name: "Lawfulness, Fairness, and Transparency"
      description: "Personal data shall be processed lawfully, fairly, and in a transparent manner in relation to the data subject"
      article_ref: "Art5_1a"
      controls:
        - "Ensure valid legal basis for all processing"
        - "Provide clear privacy notices"
        - "Maintain transparent processing activities"
    
    purpose_limitation:
      principle_id: "purpose_limitation"
      name: "Purpose Limitation"
      description: "Personal data shall be collected for specified, explicit and legitimate purposes and not further processed in a manner incompatible with those purposes"
      article_ref: "Art5_1b"
      controls:
        - "Define and document processing purposes"
        - "Prevent scope creep in data usage"
        - "Implement purpose-based access controls"
    
    data_minimization:
      principle_id: "data_minimization"
      name: "Data Minimization"
      description: "Personal data shall be adequate, relevant and limited to what is necessary in relation to the purposes for which they are processed"
      article_ref: "Art5_1c"
      controls:
        - "Collect only necessary data"
        - "Implement data minimization reviews"
        - "Regularly audit and purge unnecessary data"
    
    accuracy:
      principle_id: "accuracy"
      name: "Accuracy"
      description: "Personal data shall be accurate and, where necessary, kept up to date"
      article_ref: "Art5_1d"
      controls:
        - "Implement data validation processes"
        - "Provide data correction mechanisms"
        - "Regular data quality checks"
    
    storage_limitation:
      principle_id: "storage_limitation"
      name: "Storage Limitation"
      description: "Personal data shall be kept in a form which permits identification of data subjects for no longer than is necessary for the purposes for which the personal data are processed"
      article_ref: "Art5_1e"
      controls:
        - "Implement retention policies"
        - "Automatic deletion/anonymization"
        - "Regular data retention audits"
    
    integrity_confidentiality:
      principle_id: "integrity_confidentiality"
      name: "Integrity and Confidentiality"
      description: "Personal data shall be processed in a manner that ensures appropriate security of the personal data, including protection against unauthorised or unlawful processing and against accidental loss, destruction or damage"
      article_ref: "Art5_1f"
      controls:
        - "Implement encryption for sensitive data"
        - "Access controls and authentication"
        - "Security monitoring and incident response"
    
    accountability:
      principle_id: "accountability"
      name: "Accountability"
      description: "The controller shall be responsible for, and be able to demonstrate compliance with, the data protection principles"
      article_ref: "Art5_2"
      controls:
        - "Document all processing activities"
        - "Implement data protection policies"
        - "Regular compliance audits"
        - "Maintain records of processing activities"
  
  # Data Subject Rights
  rights:
    information:
      right_id: "information"
      name: "Right to be Informed"
      description: "Data subjects have the right to be informed about the collection and use of their personal data"
      article_refs: ["Art13", "Art14"]
      related_to_llm_attacks:
        - "information_extraction"
        - "context_manipulation"
        - "sensitive_info_disclosure"
    
    access:
      right_id: "access"
      name: "Right of Access"
      description: "Data subjects have the right to access and receive a copy of their personal data"
      article_refs: ["Art15"]
      related_to_llm_attacks:
        - "information_extraction"
        - "system_prompt_extraction"
    
    rectification:
      right_id: "rectification"
      name: "Right to Rectification"
      description: "Data subjects have the right to have inaccurate personal data corrected or completed"
      article_refs: ["Art16"]
      related_to_llm_attacks:
        - "insecure_output_handling"
        - "context_manipulation"
    
    erasure:
      right_id: "erasure"
      name: "Right to Erasure (Right to be Forgotten)"
      description: "Data subjects have the right to have personal data erased in certain circumstances"
      article_refs: ["Art17"]
      related_to_llm_attacks:
        - "information_extraction"
        - "sensitive_info_disclosure"
    
    processing_restriction:
      right_id: "processing_restriction"
      name: "Right to Restriction of Processing"
      description: "Data subjects have the right to request the restriction or suppression of their personal data"
      article_refs: ["Art18"]
      related_to_llm_attacks:
        - "prompt_injection"
        - "jailbreak"
    
    data_portability:
      right_id: "data_portability"
      name: "Right to Data Portability"
      description: "Data subjects have the right to obtain and reuse their personal data across different services"
      article_refs: ["Art20"]
      related_to_llm_attacks:
        - "model_extraction"
        - "information_extraction"
    
    object:
      right_id: "object"
      name: "Right to Object"
      description: "Data subjects have the right to object to the processing of their personal data in certain circumstances"
      article_refs: ["Art21"]
      related_to_llm_attacks:
        - "jailbreak"
        - "excessive_agency"
    
    automated_decision_making:
      right_id: "automated_decision_making"
      name: "Rights related to Automated Decision Making and Profiling"
      description: "Data subjects have the right not to be subject to a decision based solely on automated processing, including profiling"
      article_refs: ["Art22"]
      related_to_llm_attacks:
        - "jailbreak"
        - "excessive_agency"
        - "prompt_injection"
    
    data_breach_notification:
      right_id: "data_breach_notification"
      name: "Right to Be Notified of Data Breaches"
      description: "Data subjects have the right to be notified when a data breach is likely to result in a high risk to their rights and freedoms"
      article_refs: ["Art34"]
      related_to_llm_attacks:
        - "sensitive_info_disclosure"
        - "insecure_output_handling"
    
    transparency:
      right_id: "transparency"
      name: "Right to Transparent Processing"
      description: "Data subjects have the right to transparent information about processing of their personal data"
      article_refs: ["Art12"]
      related_to_llm_attacks:
        - "context_manipulation"
        - "system_prompt_extraction"
  
  # Articles Related to Controllers/Processors
  obligations:
    data_protection_by_design:
      obligation_id: "data_protection_by_design"
      name: "Data Protection by Design and by Default"
      description: "Requires appropriate technical and organizational measures to implement data protection principles, both at design time and by default"
      article_ref: "Art25"
      related_to_llm_attacks:
        - "prompt_injection"
        - "jailbreak"
        - "information_extraction"
    
    security_of_processing:
      obligation_id: "security_of_processing"
      name: "Security of Processing"
      description: "Requires implementation of appropriate technical and organizational measures to ensure a level of security appropriate to the risk"
      article_ref: "Art32"
      related_to_llm_attacks:
        - "prompt_injection"
        - "jailbreak"
        - "insecure_output_handling"
        - "sensitive_info_disclosure"
    
    dpia:
      obligation_id: "dpia"
      name: "Data Protection Impact Assessment"
      description: "Requires an assessment of the impact of the envisaged processing operations on the protection of personal data where processing is likely to result in a high risk"
      article_ref: "Art35"
      related_to_llm_attacks:
        - "jailbreak"
        - "sensitive_info_disclosure"
        - "insecure_output_handling"
