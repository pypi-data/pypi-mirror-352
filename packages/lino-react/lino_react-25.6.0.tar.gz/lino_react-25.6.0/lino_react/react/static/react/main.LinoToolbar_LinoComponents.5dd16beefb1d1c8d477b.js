"use strict";(self.webpackChunklino_react=self.webpackChunklino_react||[]).push([[8923],{6511:(e,t,n)=>{n.r(t),n.d(t,{LayoutButton:()=>E,LinoToolbar:()=>I,name:()=>P});var i=n(5072),o=n.n(i),r=n(7825),l=n.n(r),s=n(7659),a=n.n(s),c=n(5056),d=n.n(c),p=n(540),h=n.n(p),u=n(1113),_=n.n(u),A=n(8462),D={};D.styleTagTransform=_(),D.setAttributes=d(),D.insert=a().bind(null,"head"),D.domAPI=l(),D.insertStyleElement=h();o()(A.A,D);A.A&&A.A.locals&&A.A.locals;var x=n(5247),L=n(1151),S=n(6606),b=n(3748);const P="LinoToolbar";let m;m={AbortController:n.e(4166).then(n.t.bind(n,1181,23)),prButton:Promise.all([n.e(1927),n.e(5573),n.e(7236),n.e(4600),n.e(7801)]).then(n.bind(n,6286)),prInputText:Promise.all([n.e(9109),n.e(5573),n.e(7236),n.e(4600),n.e(2123)]).then(n.bind(n,8016)),prOverlayPanel:Promise.all([n.e(6190),n.e(5573),n.e(7236),n.e(4292),n.e(3618)]).then(n.bind(n,6014)),prMultiSelect:Promise.all([n.e(9109),n.e(5573),n.e(7236),n.e(4600),n.e(4292),n.e(3454),n.e(7529)]).then(n.bind(n,1496)),prSelectButton:Promise.all([n.e(7134),n.e(5573),n.e(7236),n.e(4600),n.e(8320)]).then(n.bind(n,4598)),prSplitButton:Promise.all([n.e(6190),n.e(1927),n.e(5573),n.e(7236),n.e(4600),n.e(4292),n.e(2315)]).then(n.bind(n,9360)),prToggleButton:Promise.all([n.e(7134),n.e(5573),n.e(7236),n.e(4600),n.e(5145)]).then(n.bind(n,5718)),u:Promise.resolve().then(n.bind(n,1367)),bb:Promise.resolve().then(n.bind(n,7741)),lm:Promise.resolve().then(n.bind(n,8546)),ac:Promise.all([n.e(8026),n.e(9109),n.e(4166),n.e(1927),n.e(5573),n.e(7236),n.e(4600),n.e(4292),n.e(3454),n.e(1304),n.e(644),n.e(7667)]).then(n.t.bind(n,2617,23)),i18n:Promise.all([n.e(1304),n.e(644),n.e(7211)]).then(n.bind(n,2292))};function E(e){const t=x.useContext(S.URLContextType),n=(0,S.getExReady)(m,["prSelectButton","u","i18n"],(e=>(e.i18n=e.i18n.default,e))),i=t.controller,o=x.useCallback(((e,n)=>{const o=e=>{i.isModified()?i.actionHandler.discardModDConfirm({agree:e}):e()};let r;switch(e){case L.DISPLAY_MODE_DETAIL:if(i.contextType===L.CONTEXT_TYPE_SINGLE_ROW)return;if(0===t[L.URL_PARAM_SELECTED].length){let e,t=i.dataContext.mutableContext.rows[0];t&&(e=t.hasOwnProperty("id")?t.id:"object"==typeof t?t[i.static.actorData.pk_index]:null),i.filled(e)?o((()=>i.actionHandler.singleRow(n,e))):(void 0===e&&console.warn("actorData.pk_index is undefined, cannot resolve pk!"),null===e&&console.warn("cannot open detail on a phantom row!"),i.history.replaceState({hasDetail:!1}))}else o((()=>i.actionHandler.singleRow(n,t[L.URL_PARAM_SELECTED][0])));break;case"external":const l={};[L.DISPLAY_MODE_HTML,L.DISPLAY_MODE_SUMMARY].includes(t[L.URL_PARAM_DISPLAY_MODE])&&Object.assign(l,{[L.URL_PARAM_DISPLAY_MODE]:L.DISPLAY_MODE_TABLE}),o((()=>i.actionHandler.copyContext(i.APP.URLContext,l)));break;case L.DISPLAY_MODE_HTML:case L.DISPLAY_MODE_SUMMARY:case L.DISPLAY_MODE_TABLE:case L.DISPLAY_MODE_CARDS:case L.DISPLAY_MODE_LIST:case L.DISPLAY_MODE_GALLERY:case L.DISPLAY_MODE_STORY:case L.DISPLAY_MODE_TILES:const s={[L.URL_PARAM_DISPLAY_MODE]:e};r||(r=i.contextType===L.CONTEXT_TYPE_SINGLE_ROW?i.actionHandler.multiRow:i.history.replace),o((()=>r(s)))}})),[r,l]=x.useState([]);return x.useEffect((()=>{if(!n.ready)return;const e=i.static.actorData,o=[];o.push({icon:"pi-table",help:n.i18n.t("Table view"),value:L.DISPLAY_MODE_TABLE}),t.hasDetail&&o.push({icon:"pi-file-o",help:n.i18n.t("Detail view"),value:L.DISPLAY_MODE_DETAIL}),e.available_display_modes.includes(L.DISPLAY_MODE_HTML)&&o.push({icon:"pi-arrows-h",help:n.i18n.t("Simple table view"),value:L.DISPLAY_MODE_HTML}),e.available_display_modes.includes(L.DISPLAY_MODE_LIST)&&o.push({icon:"pi-bars",help:n.i18n.t("List view"),value:L.DISPLAY_MODE_LIST}),e.available_display_modes.includes(L.DISPLAY_MODE_SUMMARY)&&o.push({icon:"pi-ellipsis-h",help:n.i18n.t("Summary view"),value:L.DISPLAY_MODE_SUMMARY}),e.available_display_modes.includes(L.DISPLAY_MODE_TILES)&&o.push({icon:"pi-microsoft",help:n.i18n.t("Tiles view"),value:L.DISPLAY_MODE_TILES}),e.available_display_modes.includes(L.DISPLAY_MODE_STORY)&&o.push({icon:"pi-map",help:n.i18n.t("Story view"),value:L.DISPLAY_MODE_STORY}),e.available_display_modes.includes(L.DISPLAY_MODE_GALLERY)&&o.push({icon:"pi-clone",help:n.i18n.t("Gallery view"),value:L.DISPLAY_MODE_GALLERY}),e.available_display_modes.includes(L.DISPLAY_MODE_CARDS)&&o.push({icon:"pi-th-large",help:n.i18n.t("Card view"),value:L.DISPLAY_MODE_CARDS}),i.isSlave&&e.editable&&o.push({icon:"pi-eject",help:n.i18n.t("Expand this panel to own window"),value:"external"}),l(o)}),[n.ready,t.hasDetail]),n.ready?(0,b.jsx)(n.prSelectButton.SelectButton,{itemTemplate:e=>(0,b.jsx)("i",{title:e.help,className:"pi "+e.icon}),onChange:e=>o(e.value,e),options:r,value:t[L.URL_PARAM_DISPLAY_MODE]}):null}(0,S.RegisterImportPool)(m);class I extends S.Component{async prepare(){await super.prepare(),this.ex.i18n=this.ex.i18n.default}constructor(e){super(e),this.state={...this.state,query:e.query||"",key:"whatev"},this.renderActionBar=this.renderActionBar.bind(this),this.renderDataViewSortButton=this.renderDataViewSortButton.bind(this),this.renderDetailNavigator=this.renderDetailNavigator.bind(this),this.renderEditorButton=this.renderEditorButton.bind(this),this.renderParamValueControls=this.renderParamValueControls.bind(this),this.renderQuickFilter=this.renderQuickFilter.bind(this),this.renderToggle_colControls=this.renderToggle_colControls.bind(this)}onReady(){this.controller=new this.ex.AbortController.default}renderActionBar(e,t){return(0,b.jsx)(this.ex.bb.LinoBbar,{onSide:e,nonCollapsibles:t,an:this.context[L.URL_PARAM_DISPLAY_MODE]===L.DISPLAY_MODE_DETAIL?"show"===this.context.controller.static.actorData.default_action?"show":"detail":"grid"})}renderDataViewSortButton(){if(this.context[L.URL_PARAM_DISPLAY_MODE]===L.DISPLAY_MODE_DETAIL)return;let e=this.context.controller.static.actorData;const t=e.col.map((t=>({label:t.name,value:String(t.fields_index),command:t=>{let n=parseInt(t.item.value);this.context.controller.history.replace({[L.URL_PARAM_SORT]:e.col.filter((e=>e.fields_index===n))[0].name,[L.URL_PARAM_SORTDIR]:"DESC",sortField:n,sortOrder:1})}})));return(0,b.jsx)(this.ex.prSplitButton.SplitButton,{icon:0===this.context.sortOrder?"pi pi-sort-alt":1===this.context.sortOrder?"pi pi-sort-amount-up":"pi pi-sort-amount-down",label:this.ex.i18n.t("Sort by {{value}}",{value:this.context[L.URL_PARAM_SORT]||""}),model:t,onClick:e=>{let t=1===this.context.sortOrder?-1:1;this.context.controller.history.replace({[L.URL_PARAM_SORTDIR]:1===t?"DESC":"ASC",sortOrder:t})},style:{verticalAlign:"bottom"}})}renderDetailNavigator(){if(this.context[L.URL_PARAM_DISPLAY_MODE]!==L.DISPLAY_MODE_DETAIL)return null;let e=this.context.controller.dataContext.mutableContext.navinfo,t=this.props.parent.state.loading;const n=e=>{this.props.parent.LinoDetail.navigate(e)};return e&&(0,b.jsxs)(x.Fragment,{children:[(0,b.jsx)(this.ex.prButton.Button,{disabled:t||null===e.prev,className:"l-nav-first",icon:"pi pi-angle-double-left",onClick:e=>n("first")}),(0,b.jsx)(this.ex.prButton.Button,{disabled:t||null===e.prev,className:"l-nav-prev",icon:"pi pi-angle-left",onClick:e=>n("prev")}),(0,b.jsx)(this.ex.prButton.Button,{disabled:t||null===e.next,className:"l-nav-next",icon:"pi pi-angle-right",onClick:e=>n("next")}),(0,b.jsx)(this.ex.prButton.Button,{disabled:t||null===e.next,className:"l-nav-last",icon:"pi pi-angle-double-right",onClick:e=>n("last")})]})}renderEditorButton(){let e=this.context.controller,t=e.static.actorData;return this.context[L.URL_PARAM_DISPLAY_MODE]!==L.DISPLAY_MODE_DETAIL||!t.editable||t.edit_safe||e.dataContext.contextBackup.disable_editing?null:(0,b.jsx)(this.ex.prToggleButton.ToggleButton,{checked:!this.context.editing_mode,className:"l-bbar-editor-button",onChange:e=>{this.ex.u.toggleEditingMode(this.context)},onLabel:"",offLabel:"",offIcon:"pi pi-times",onIcon:"pi pi-pencil",tooltip:this.context.editing_mode?this.ex.i18n.t("Cancel"):this.ex.i18n.t("Edit"),tooltipOptions:{position:"bottom"}})}renderParamValueControls(){return this.context.controller.static.actorData.params_layout&&(0,b.jsxs)(x.Fragment,{children:[(0,b.jsx)(this.ex.prButton.Button,{icon:"pi pi-sliders-h",onClick:e=>{this.context.controller.history.replace({pvPVisible:!this.context.pvPVisible})},tooltip:this.context.pvPVisible?this.ex.i18n.t("Hide parameters panel"):this.ex.i18n.t("Show parameters panel"),tooltipOptions:{position:"bottom"}}),0!==Object.keys(this.context[L.URL_PARAM_PARAM_VALUES]||{}).length&&(0,b.jsx)(this.ex.prButton.Button,{icon:"pi pi-times-circle",onClick:()=>{let e=this.context.controller;e.dataContext.updateState({param_values:{...e.dataContext.contextBackup.param_values}}),e.history.replace({pv:[]})},tooltip:this.ex.i18n.t("Clear and set the parameter values to default"),tooltipOptions:{position:"bottom"}})]})}renderQuickFilter(e){return(0,b.jsx)("span",{onKeyDown:e=>{"Delete"===e.code&&e.stopPropagation()},children:this.context[L.URL_PARAM_DISPLAY_MODE]===L.DISPLAY_MODE_DETAIL?(0,b.jsx)(this.ex.ac.QuickFilter,{urlParams:this.context,wide:!!e}):(0,b.jsx)(this.ex.prInputText.InputText,{className:"l-grid-quickfilter",onChange:e=>{let t=e.target.value;this.setState({query:t}),this.props.parent.quickFilter({query:t})},placeholder:this.ex.i18n.t("Quick search"),ref:e=>{e&&this.context.currentInputWindowType===L.WINDOW_TYPE_UNKNOWN&&0===this.context.currentInputTabIndex&&e.focus()},style:{width:e?"100%":void 0,marginRight:e?"1ch":void 0,marginLeft:e?"1ch":void 0},value:this.state.query})})}renderToggle_colControls(){return this.context[L.URL_PARAM_DISPLAY_MODE]!==L.DISPLAY_MODE_TABLE?null:(0,b.jsxs)(x.Fragment,{children:[(0,b.jsx)(this.ex.prButton.Button,{icon:"pi pi-list",onClick:e=>this.col_selector_op.toggle(e),tooltip:this.ex.i18n.t("Configure visibility of the grid columns"),tooltipOptions:{position:"bottom"}}),(0,b.jsx)(this.ex.prOverlayPanel.OverlayPanel,{onHide:e=>this.col_selector.hide(),onShow:e=>this.col_selector.show(),ref:e=>this.col_selector_op=e,children:(0,b.jsx)(this.ex.prMultiSelect.MultiSelect,{panelStyle:{zIndex:"99999",height:"auto",width:"auto",position:"absolute"},value:Array.from(this.context.showableColumns.keys()),options:this.context.controller.static.actorData.col.map((e=>({label:e.label,value:e.fields_index}))),onChange:e=>{let t=new Map;e.value.forEach(((e,n)=>{t.set(e,this.context.controller.static.actorData.col.find((t=>t.fields_index===e)).name)})),this.context.controller.history.replace({showableColumns:t}),this.props.parent.GridElement.set_cols()},onHide:e=>this.col_selector_op.hide(),ref:e=>this.col_selector=e})})]})}render(){if(!this.state.ready)return null;let e=this.context.controller.static.actorData;return(0,b.jsxs)(x.Fragment,{children:[this.context.toolbarState==L.TOOLBAR_STATE_VISIBLE?(0,b.jsx)(x.Fragment,{children:(0,b.jsxs)("div",{className:"table-header",children:[(0,b.jsxs)("div",{className:"l-bbar-left",style:{background:"transparent"},children:[!e.hide_navigator&&(0,b.jsxs)(x.Fragment,{children:[this.renderQuickFilter(),this.context[L.URL_PARAM_DISPLAY_MODE]!==L.DISPLAY_MODE_TABLE?this.renderDataViewSortButton():this.renderToggle_colControls(),this.renderDetailNavigator()]}),this.renderActionBar(!1),this.renderEditorButton()]}),(0,b.jsx)(E,{})]})}):this.props.side?(0,b.jsxs)(x.Fragment,{children:[!e.hide_navigator&&(0,b.jsxs)(x.Fragment,{children:[this.renderDetailNavigator(),this.context[L.URL_PARAM_DISPLAY_MODE]===L.DISPLAY_MODE_TABLE&&this.renderToggle_colControls()]}),this.renderActionBar(!0),this.renderEditorButton()]}):!e.hide_top_toolbar&&this.context.toolbarState==L.TOOLBAR_STATE_PARTIALLY_VISIBLE&&(0,b.jsx)(x.Fragment,{children:(0,b.jsxs)("div",{className:"table-header",children:[(0,b.jsxs)("div",{className:"l-bbar-left",style:{background:"transparent"},children:[!e.hide_navigator&&(0,b.jsxs)(x.Fragment,{children:[this.renderQuickFilter(),this.context[L.URL_PARAM_DISPLAY_MODE]!==L.DISPLAY_MODE_TABLE&&this.renderDataViewSortButton()]}),this.renderActionBar(!1,!0)]}),(0,b.jsx)(E,{})]})}),!this.props.side&&(0,b.jsx)(this.ex.lm.LinoProgressBar,{loading:this.props.parent.state.loading})]},this.state.key)}}I.requiredModules=["AbortController","prButton","prInputText","prOverlayPanel","prMultiSelect","prSplitButton","prToggleButton","bb","lm","u","ac","i18n"],I.iPool=m,I.contextType=S.URLContextType},8462:(e,t,n)=>{n.d(t,{A:()=>s});var i=n(6995),o=n.n(i),r=n(8065),l=n.n(r)()(o());l.push([e.id,".l-header {\n    padding: 3px;\n    border: 1px solid #8080804d;\n}\n.l-whitewall-body-container .p-button.p-component {\n    /* color: #ffffff70; */\n}\n.l-whitewall-body-container .p-inputtext {\n    /* background: transparent;\n    color: unset; */\n}\n","",{version:3,sources:["webpack://./lino_react/react/components/LinoToolbar.css"],names:[],mappings:"AAAA;IACI,YAAY;IACZ,2BAA2B;AAC/B;AACA;IACI,sBAAsB;AAC1B;AACA;IACI;mBACe;AACnB",sourcesContent:[".l-header {\n    padding: 3px;\n    border: 1px solid #8080804d;\n}\n.l-whitewall-body-container .p-button.p-component {\n    /* color: #ffffff70; */\n}\n.l-whitewall-body-container .p-inputtext {\n    /* background: transparent;\n    color: unset; */\n}\n"],sourceRoot:""}]);const s=l}}]);
//# sourceMappingURL=main.LinoToolbar_LinoComponents.5dd16beefb1d1c8d477b.js.map