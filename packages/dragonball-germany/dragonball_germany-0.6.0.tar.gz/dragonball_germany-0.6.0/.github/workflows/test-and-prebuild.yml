name: test-and-prebuild

on:
    pull_request:
        branches:
            - master
        paths:
            - 'dragonball_germany/**'
            - 'tests/**'

env:
    PYTHON_VERSION: '3.12'

jobs:
    test-and-prebuild:
        runs-on: ubuntu-latest

        steps:
            - name: Checkout code
              uses: actions/checkout@v4

            - name: Set up Python${{ env.PYTHON_VERSION }}
              uses: actions/setup-python@v4
              with:
                  python-version: ${{ env.PYTHON_VERSION }}

            - name: Install pip
              run: python -m pip install --upgrade pip

            - name: Install dependencies
              run: pip install -r 'requirements.txt'

            - name: Install dev dependencies
              run: pip install -r 'requirements-dev.txt'

            - name: Install build dependencies
              run: pip install setuptools wheel build twine

            - name: Build package
              run: python -m build
