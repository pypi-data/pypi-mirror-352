<?xml version="1.0" encoding="utf-8" ?>
<!--Copyright 2023 OpenSynergy Indonesia-->
<!--Copyright 2023 PT. Simetri Sinergi Indonesia-->
<!--License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl).-->
<odoo>
<record id="rma_supplier_view_tree" model="ir.ui.view">
    <field name="name">RMA Suppliers - Tree</field>
    <field name="model">rma_supplier</field>
    <field name="inherit_id" ref="ssi_rma.rma_supplier_view_tree" />
    <field name="arch" type="xml">
        <data>
            <xpath expr="//field[@name='percent_delivery']" position="after">
                <field name="need_refund" optional="hide" />
                <field
                        name="percent_refund"
                        string="Refund"
                        optional="show"
                        widget="percentage"
                    />
            </xpath>
        </data>
    </field>
</record>

<record id="rma_supplier_view_form" model="ir.ui.view">
    <field name="name">RMA Suppliers - Form</field>
    <field name="model">rma_supplier</field>
    <field name="inherit_id" ref="ssi_rma.rma_supplier_view_form" />
    <field name="arch" type="xml">
        <data>
            <xpath expr="//button[@name='action_open_delivery']" position="after">
                <button
                        name="action_open_refund"
                        class="oe_stat_button"
                        type="object"
                        icon="fa-money"
                    >
                    <div class="o_field_widget o_stat_info">
                        <span class="o_stat_value">
                            <field name="num_of_refund" />
                        </span>
                        <span class="o_stat_text">Refund</span>
                    </div>
                </button>
            </xpath>
            <xpath expr="//field[@name='rma_state']" position="after">
                <button
                        name="%(link_journal_item_rma_line_action)d"
                        type="action"
                        help="Link To Journal Items"
                        icon="fa-credit-card"
                        attrs="{'invisible': [('rma_state','!=','open')]}"
                    />
            </xpath>
            <xpath expr="//group[@name='quantity_1_1']" position="inside">
                <field name="qty_to_refund" />
            </xpath>
            <xpath expr="//group[@name='quantity_1_2']" position="inside">
                <field name="qty_refund" />
            </xpath>
            <xpath
                    expr="//page[@name='procurement']//field[@name='stock_move_ids']"
                    position="after"
                >
                <separator name="svl" string="Stock Valuation Layers" />
                <field name="stock_valuation_layer_ids" nolabel="1" />
            </xpath>
            <xpath expr="//notebook/page[@name='procurement']" position="after">
                <page name="accounting" string="Accounting">
                    <button
                            name="action_create_refund"
                            type="object"
                            string="Create Refund"
                            attrs="{'invisible':[('refund_ok','=',False)]}"
                            class="oe_highlight"
                            icon="fa-credit-card"
                            style="margin-right:4px"
                        />
                    <group name="accounting_1" colspan="4" col="2">
                        <field name="journal_id" />
                        <field name="usage_id" />
                        <field name="refund_pricelist_id" />
                        <field name="refund_ok" groups="base.group_no_one" />
                    </group>
                </page>
            </xpath>
            <xpath
                    expr="//field[@name='line_ids']/form/notebook/page[@name='move']"
                    position="after"
                >
                <page name="aml" string="Journal Items">
                    <field name="account_move_line_ids" />
                </page>
            </xpath>
            <xpath
                    expr="//field[@name='line_ids']/tree/field[@name='delivery_complete']"
                    position="after"
                >
                <field name="need_refund" optional="hide" />
                <field
                        name="percent_refund"
                        string="Refund"
                        optional="show"
                        widget="percentage"
                    />
                <field name="refund_complete" invisible="1" />
            </xpath>
            <xpath
                    expr="//field[@name='line_ids']/form/notebook//group[@name='quantity1']"
                    position="inside"
                >
                <field name="qty_to_refund" />
            </xpath>
            <xpath
                    expr="//field[@name='line_ids']/form/notebook//group[@name='quantity2']"
                    position="inside"
                >
                <field name="qty_refund" />
            </xpath>
            <xpath expr="//group[@name='quantity_1_3']" position="inside">
                <field name="percent_refund" widget="percentage" />
                <field name="need_refund" />
            </xpath>
        </data>
    </field>
</record>

<record id="rma_supplier_view_form1" model="ir.ui.view">
    <field name="name">RMA Supplier - Form - Editable Journal Items</field>
    <field name="model">rma_supplier</field>
    <field name="inherit_id" ref="ssi_rma_account.rma_supplier_view_form" />
    <field name="groups_id" eval="[(4, ref('base.group_system'))]" />
    <field name="arch" type="xml">
        <xpath
                expr="//page[@name='aml']/field[@name='account_move_line_ids']"
                position="attributes"
            >
            <attribute name="readonly">0</attribute>
        </xpath>
    </field>
</record>
</odoo>
